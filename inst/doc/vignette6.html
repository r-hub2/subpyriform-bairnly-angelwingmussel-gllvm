<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Bert van der Veen" />

<meta name="date" content="2024-11-22" />

<title>Ordination with predictors</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Ordination with predictors</h1>
<h4 class="author">Bert van der Veen</h4>
<h4 class="date">2024-11-22</h4>



<p>Until recently, the <code>gllvm</code> R-package only supported
unconstrained ordination. When including predictor variables, the
interpretation of the ordination would shift to a residual ordination,
conditional on the predictors.</p>
<p>However, if the number of predictor variables is large and so is the
number of species, including predictors can result in a very large
number of parameters to estimate. For data of ecological communities,
which can be quite sparse, this is not always a reasonable model to fit.
As alternative, ecologists have performed constrained ordination for
decades, with methods such as Canonical Correspondence Analysis, or
Redundancy Analysis. Alternatively, these methods can be viewed as
determining “gradients” (a.k.a. latent variables) as a linear
combination of the predictor variables.</p>
<p>In this vignette, we demonstrate how to include predictors directly
in an ordination with the <code>gllvm</code> R-package. Methods are
explained with details in <span class="citation">van der Veen et al.
(2023)</span>. We start by loading the hunting spider dataset:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gllvm)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;spider&quot;</span>, <span class="at">package =</span> <span class="st">&quot;mvabund&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> spider<span class="sc">$</span>abund</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> spider<span class="sc">$</span>x</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#And scale the predictors</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(X)</span></code></pre></div>
<p>which includes six predictor variables: “soil.dry”: soil dry mass,
“bare.sand”: cover bare sand, “fallen.leaves”: “cover of fallen leaves”,
“moss”: cover moss, “herb.layer”: cover of the herb layer, “reflection”:
“reflection of the soil surface with a cloudless sky”.</p>
<div id="constrained-ordination" class="section level2">
<h2>Constrained ordination</h2>
<p>Let us first consider what constrained ordination actually is. We
will do that by first shortly explaining reduced rank regression (RRR).
First, consider the model:</p>
<p><span class="math display">\[
\eta_{ij} = \beta_{0j} + \boldsymbol{X}_i^\top\boldsymbol{\beta}_j.
\]</span></p>
<p>Here, <span class="math inline">\(\boldsymbol{\beta}_j\)</span> are
the slopes that represent a species responses to <span class="math inline">\(p\)</span> predictor variables at site <span class="math inline">\(i\)</span>, <span class="math inline">\(\boldsymbol{X}_i\)</span>. In the
<code>gllvm</code> R-package, the code to fit this model is:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>MGLM <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">num.lv =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>where we set the number of unconstrained latent variables to zero, as
it defaults to two. The “rank” of <span class="math inline">\(\boldsymbol{X}_i^\top\boldsymbol{\beta}_j\)</span>
is <span class="math inline">\(p\)</span>. Constrained ordination
introduces a constraint on the species slopes matrix, namely on the
number of independent columns in <span class="math inline">\(\boldsymbol{\beta}_j\)</span> (a column is not
independent when it can be formulated as a linear combination of
another). The reduced ranks are in community ecology referred to as
ecological gradients, but can also be understood as ordination axes or
latent variables. If we define a latent variable <span class="math inline">\(\boldsymbol{z}_i =
\boldsymbol{B}^\top\boldsymbol{X}_{i,lv} +
\boldsymbol{\epsilon}_i\)</span>, for a <span class="math inline">\(p\times d\)</span> matrix of slopes, we can
understand constrained ordination as a regression of the latent variable
or ecological gradient, except that the residual <span class="math inline">\(\boldsymbol{\epsilon}_i\)</span> is omitted,
i.e. we assume that the ecological gradient can be represented perfectly
by the predictor variables, so that the model becomes: <span class="math display">\[\begin{equation}
\eta_{ij} = \beta_{0j} +
\boldsymbol{X}_i^\top\boldsymbol{B}\boldsymbol{\gamma}_j.
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(\boldsymbol{B}\)</span> is a <span class="math inline">\(d \times K\)</span> matrix of slopes per predictor
and latent variable, and <span class="math inline">\(\boldsymbol{\gamma}_j\)</span> is a set of slopes
for each species per latent variable. This parametrization is
practically useful, as it drastically reduces the number of parameters
compared to multivariate regression. The rank, number of latent
variables or ordination axes, can be determined by cross-validation, or
alternatively by using information criteria. The code for this in the
<code>gllvm</code> R-package, for an arbitrary choice of two latent
variables, is:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>RRGLM <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">num.RR =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The predictor slopes (called canonical coefficients in e.g., CCA or
RDA) are available under <code>RRGLM$params$LvXcoef</code> or can be
retrieved with <code>coef(RRGLM)</code> or by
<code>summary(RRGLM)</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">summary</span>(RRGLM, <span class="at">rotate =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## gllvm(y = Y, X = X, family = &quot;poisson&quot;, num.RR = 6, starting.val = &quot;zero&quot;, 
##     reltol.c = 1e-15)
## 
## Family:  poisson 
## 
## AIC:  1841.216 AICc:  1898.108 BIC:  2161.853 LL:  -836.6 df:  84 
## 
## Informed LVs:  0 
## Constrained LVs:  6 
## Unconstrained LVs:  0 
## 
## Formula:  ~ 1 
## LV formula:  ~soil.dry + bare.sand + fallen.leaves + moss + herb.layer + reflection 
## Row effect:  ~ 1 
## 
## Coefficients LV predictors:
##                      Estimate Std. Error z value Pr(&gt;|z|)    
## soil.dry(CLV1)       0.739241   0.545770   1.354  0.17558    
## bare.sand(CLV1)     -1.504227   0.738137  -2.038  0.04156 *  
## fallen.leaves(CLV1)  0.249424   1.567803   0.159  0.87360    
## moss(CLV1)          -0.406028   1.325428  -0.306  0.75935    
## herb.layer(CLV1)     1.983275   1.046501   1.895  0.05807 .  
## reflection(CLV1)    -2.069525   0.941468  -2.198  0.02794 *  
## soil.dry(CLV2)      -0.524884   0.325749  -1.611  0.10711    
## bare.sand(CLV2)     -0.761665   0.395216  -1.927  0.05395 .  
## fallen.leaves(CLV2) -0.877375   0.969414  -0.905  0.36543    
## moss(CLV2)           0.130217   0.659360   0.197  0.84344    
## herb.layer(CLV2)     1.793405   0.584467   3.068  0.00215 ** 
## reflection(CLV2)     0.315377   0.600692   0.525  0.59957    
## soil.dry(CLV3)       0.750252   0.988362   0.759  0.44780    
## bare.sand(CLV3)     -0.897121   0.928729  -0.966  0.33406    
## fallen.leaves(CLV3) -1.145885   1.649139  -0.695  0.48716    
## moss(CLV3)          -0.342914   0.768733  -0.446  0.65554    
## herb.layer(CLV3)    -1.345636   1.047277  -1.285  0.19883    
## reflection(CLV3)     0.820609   0.674645   1.216  0.22385    
## soil.dry(CLV4)      -0.997668   0.514773  -1.938  0.05261 .  
## bare.sand(CLV4)     -0.522736   0.432766  -1.208  0.22709    
## fallen.leaves(CLV4) -0.606122   1.004898  -0.603  0.54640    
## moss(CLV4)           0.150650   0.698787   0.216  0.82931    
## herb.layer(CLV4)     0.026434   0.669088   0.040  0.96849    
## reflection(CLV4)    -1.211241   0.496380  -2.440  0.01468 *  
## soil.dry(CLV5)       0.592508   0.230516   2.570  0.01016 *  
## bare.sand(CLV5)      0.430542   0.196589   2.190  0.02852 *  
## fallen.leaves(CLV5) -0.814613   0.341699  -2.384  0.01713 *  
## moss(CLV5)           0.289127   0.182575   1.584  0.11328    
## herb.layer(CLV5)    -0.160839   0.253159  -0.635  0.52521    
## reflection(CLV5)    -0.726094   0.149143  -4.868 1.12e-06 ***
## soil.dry(CLV6)      -0.031456   0.020354  -1.545  0.12224    
## bare.sand(CLV6)      0.004485   0.014587   0.307  0.75850    
## fallen.leaves(CLV6) -0.057097   0.033731  -1.693  0.09051 .  
## moss(CLV6)          -0.086429   0.020041  -4.313 1.61e-05 ***
## herb.layer(CLV6)    -0.015565   0.019434  -0.801  0.42316    
## reflection(CLV6)    -0.009270   0.014017  -0.661  0.50840    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note the use of the <code>rotate</code> argument. This ensures that
the solution of the canonical coefficients is rotated to the same
solution as displayed in <code>ordiplot</code> (which has the same
<code>rotate</code> argument that is by default set to TRUE). The
summary can be useful in determining what drives vertical and horizontal
shifts in the location of species and sites in the ordination diagram
(but probably not for much more than that).</p>
<p>Unlike the canonical coefficients, the reconstructed species-specific
effects are invariant to rotation, so that it is always good practice to
additionally study those for more exhaustive inference;</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">coefplot</span>(RRGLM, <span class="at">cex.ylab =</span> <span class="fl">0.5</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="plot of chunk coefsP" src="data:image/png;base64,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" alt="plot of chunk coefsP" />
<p class="caption">
plot of chunk coefsP
</p>
</div>
<p>To fit a constrained ordination we make use of additional
optimization routines from the and R-packages. This is necessary,
because without the constraint that the predictor slopes are orthogonal
the model is <em>unidentifiable</em>. It might thus happen, that after
fitting the model a warning pops-up along the lines of <em>predictor
slopes are not orthogonal</em>, in which case you will have to re-fit
the model with a different optimization routine
(<code>optimizer=&#39;alabama&#39;</code>) or starting values
(<code>starting.values=&#39;zero&#39;</code>) in order to get the constraints on
the canonical coefficients to better converge.</p>
<p>Note: in general to improve convergence, it is good practice to
center and scale the predictor variables.</p>
<div id="random-slopes" class="section level3">
<h3>Random slopes</h3>
<p>Generally, constrained ordination can have difficulty in estimating
the predictor slopes, for example due to co-linearity between the
predictors. One way to solve this, is using regularisation.
Regularisation adds a penalty to the objective function, as to shrink
parameter estimates closer to zero that are unimportant. A convenient
way to add this penalty, is by formulating a random slopes model. In
<code>gllvm</code> this is done with the following syntax:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>RRGLMb1 <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">num.RR =</span> <span class="dv">2</span>, <span class="at">randomB =</span> <span class="st">&quot;LV&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>RRGLMb1 <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">num.RR =</span> <span class="dv">2</span>, <span class="at">randomB =</span> <span class="st">&quot;P&quot;</span>)</span></code></pre></div>
<p>where the <code>randomB</code> argument is additionally used to
specify if variances of the random slopes should be unique per latent
variable (i.e. assume that the random slopes per predictor come from the
same distribution), or per predictor (i.e. assume that the random slopes
per latent variable come from the same distribution). Either setting has
benefits, the first implies covariance between species responses to a
predictor, whereas the latter can serve to shrink effects of a single
predictor to near zero. In general, it has the potential to stabilize
model fitting and reduce variance of the parameter estimates. Finally, a
slope for a categorical predictor is an intercept, so this formulation
also allows to include random intercepts in the ordination.</p>
<p>A plot of species-specific effects can be constructed with the
<code>randomCoefplot</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">randomCoefplot</span>(RRGLMb1, <span class="at">cex.ylab =</span> <span class="fl">0.5</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="plot of chunk rcoefs" src="data:image/png;base64,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" alt="plot of chunk rcoefs" />
<p class="caption">
plot of chunk rcoefs
</p>
</div>
<p>When using a random-effects formulation, there is no summary table
and there are no confidence intervals available for the canonical
coefficients. It is possible to construct a summary table with the
prediction of the random-effects and the association prediction errors
as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Get coefficients</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>coefs<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">coef</span>(RRGLMb1,<span class="st">&quot;LvXcoef&quot;</span>))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>coefs<span class="sc">$</span>Predictor <span class="ot">&lt;-</span> <span class="fu">row.names</span>(coefs)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Wide to long</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>coefsTab<span class="ot">&lt;-</span><span class="fu">reshape</span>(coefs, </span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">&quot;long&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>        <span class="at">varying =</span> <span class="fu">list</span>(<span class="fu">colnames</span>(coefs)[<span class="dv">1</span><span class="sc">:</span>(RRGLMb1<span class="sc">$</span>num.lv.c<span class="sc">+</span>RRGLMb1<span class="sc">$</span>num.RR)]),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>        <span class="at">v.names =</span> <span class="st">&quot;Estimate&quot;</span>, </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>        <span class="at">times=</span><span class="fu">colnames</span>(coefs)[<span class="dv">1</span><span class="sc">:</span>(RRGLMb1<span class="sc">$</span>num.lv.c<span class="sc">+</span>RRGLMb1<span class="sc">$</span>num.RR)], </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>        <span class="at">timevar =</span> <span class="st">&quot;LV&quot;</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>        <span class="at">new.row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co"># Add prediction errors</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>coefsTab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coefsTab,<span class="at">PE=</span><span class="fu">c</span>(<span class="fu">getPredictErr</span>(RRGLMb1)<span class="sc">$</span>b.lv))</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">row.names</span>(coefsTab)<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(coefsTab)</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>coefsTab[,<span class="sc">-</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>##        Predictor   LV    Estimate         PE
## 1       soil.dry CLV1 -0.03060679 0.07595329
## 2      bare.sand CLV1  0.06496518 0.05952885
## 3  fallen.leaves CLV1 -0.33992690 0.10803090
## 4           moss CLV1  0.83103837 0.09507550
## 5     herb.layer CLV1  0.46862694 0.11450077
## 6     reflection CLV1  0.78034055 0.12797780
## 7       soil.dry CLV2  0.91414792 0.09913801
## 8      bare.sand CLV2 -0.11276960 0.04106647
## 9  fallen.leaves CLV2 -0.25673882 0.14442907
## 10          moss CLV2 -0.21977825 0.32165464
## 11    herb.layer CLV2  0.63662194 0.19660301
## 12    reflection CLV2 -0.21137650 0.29998929</code></pre>
<p>There is a range of potential use cases for random canonical
coefficients, but pragmatically, inducing some shrinkage on the
predictor effects can result in more better “behaved” (fewer outliers)
ordination plots.</p>
<p>Incorporating correlation between the canonical coefficients is
(currently) only possible in combination with <code>randomB=&quot;P&quot;</code>.
This assumes that the canonical coefficients per LV are drawn from a
covariance matrix that is specified with the <code>lv.formula</code>
argument:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>RRGLMb2 <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">lv.formula =</span> <span class="sc">~</span>(<span class="dv">0</span><span class="sc">+</span>soil.dry<span class="sc">+</span>bare.sand<span class="sc">+</span>fallen.leaves<span class="sc">+</span>moss<span class="sc">+</span>herb.layer<span class="sc">+</span>reflection<span class="sc">|</span><span class="dv">1</span>), <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">num.RR =</span> <span class="dv">2</span>, <span class="at">randomB =</span> <span class="st">&quot;P&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">summary</span>(RRGLMb2)</span></code></pre></div>
<pre><code>## 
## Call:
## gllvm(y = Y, X = X, family = &quot;poisson&quot;, num.RR = 2, lv.formula = ~(0 + 
##     soil.dry + bare.sand + fallen.leaves + moss + herb.layer + 
##     reflection | 1), randomB = &quot;P&quot;)
## 
## Family:  poisson 
## 
## AIC:  2402.894 AICc:  2413.434 BIC:  2551.761 LL:  -1162.4 df:  39 
## 
## Informed LVs:  0 
## Constrained LVs:  2 
## Unconstrained LVs:  0 
## 
## Formula:  ~ 1 
## LV formula:  ~(0 + soil.dry + bare.sand + fallen.leaves + moss + herb.layer + reflection | 1) 
## Row effect:  ~ 1 
## 
## Random effects LV predictors:
##  Name          Variance Std.Dev
##  soil.dry      0.4174   0.6461 
##  bare.sand     0.0049   0.0700 
##  fallen.leaves 0.1125   0.3354 
##  moss          0.3404   0.5835 
##  herb.layer    0.4036   0.6353 
##  reflection    0.3353   0.5790</code></pre>
<p>For this, we make use of an adjusted version of the familiar
lme4-formula interface <span class="citation">Douglas Bates et al.
(2024)</span>. This is equivalent to assuming that the matrix of species
coefficients follows a matrix normal distribution <span class="math inline">\(\boldsymbol{\beta} \sim \mathcal{MN}(\textbf{0},
\boldsymbol{\Sigma},
\boldsymbol{\Gamma}\boldsymbol{\Gamma}^\top)\)</span>, so that the
correlations are indeed the correlation of the predictor effects,
estimated in reduced rank, and the species loadings form the
column-covariance matrix, i.e., provide the species correlations in
reduced rank.</p>
</div>
<div id="group-level-unconstrained-ordination" class="section level3">
<h3>Group-level unconstrained ordination</h3>
<p>Frequently, ecological datasets contain some kind of grouping
structure. In these cases we might want to define the ordination at the
group-level, rather than having a score for each row in the response
matrix. An ordination where the scores are grouped based on (e.g.,
areas, plots or other groups) is also a constrained (or concurrent, see
below) ordination. If there are only grouping variables, and no other
predictors, the ordination is constrained relative to an ordination
where the scores are defined per row in the response matrix, but the
group-level scores themselves are unconstrained. If there are also other
(continuous) predictors that is also fine, it just meansn that we end up
with a concurrent ordination where the LV-level error is defined at the
group-level.</p>
<p>Here is an example with four artificial groups:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>groupUGLLVM <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">7</span>)), <span class="at">lv.formula =</span> <span class="sc">~</span>(<span class="dv">1</span><span class="sc">|</span>group), <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">num.RR =</span> <span class="dv">2</span>, <span class="at">randomB =</span> <span class="st">&quot;LV&quot;</span>, <span class="at">starting.val =</span> <span class="st">&quot;zero&quot;</span>) <span class="co"># starting.val added because it gave a better fit here</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">ordiplot</span>(groupUGLLVM, <span class="at">arrow.scale =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="plot of chunk ordip6_1" src="data:image/png;base64,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" alt="plot of chunk ordip6_1" />
<p class="caption">
plot of chunk ordip6_1
</p>
</div>
</div>
</div>
<div id="fixed-effects-unconstrained-ordination" class="section level2">
<h2>Fixed effects unconstrained ordination</h2>
<p>Following the same ideas, we can also abuse the <code>num.RR</code>
interface to fit a fixed effects unconstrained ordination:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>fixUGLLVM <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> <span class="fu">data.frame</span>(<span class="at">site =</span> <span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Y))), <span class="at">lv.formula =</span> <span class="sc">~</span>site, <span class="at">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="at">num.RR =</span> <span class="dv">2</span>) <span class="co"># starting.val added because it gave a better fit here</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">ordiplot</span>(fixUGLLVM, <span class="at">arrow.scale =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="plot of chunk fixuGLLVM" src="data:image/png;base64,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" alt="plot of chunk fixuGLLVM" />
<p class="caption">
plot of chunk fixuGLLVM
</p>
</div>
</div>
<div id="concurrent-ordination" class="section level2">
<h2>Concurrent ordination</h2>
<p>Unlike in other R-packages, we can now formulate a ordination where
additional random-effects are included that act like LV-level residuals
(because let’s face it, how often are we 100% confident that we have
measured all relevant predictors?), so that we can assume that the
ecological gradient is represented by unmeasured and measured predictors
(the former is how the residual can be understood). The code for this
is:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>CGLLVM <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">num.lv.c =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>where the <code>num.lv.c</code> argument is used to specify the
number of latent variables for the concurrent ordination (i.e. latent
variables informed by the predictors but not constrained), where
previously the <code>num.RR</code> argument was used to specify the
number of constrained latent variables. The number of constrained,
informed, and unconstrained latent variables can be freely combined
using the <code>num.RR</code>, <code>num.lv.c</code> and
<code>num.lv</code> arguments (but be careful not to overparameterize or
overfit your model!).</p>
</div>
<div id="partial-constrained-or-concurrent-ordination" class="section level2">
<h2>Partial constrained or concurrent ordination</h2>
<p>It is also possible to combine constrained or concurrent ordination
with full-rank predictor effects. To combine concurrent ordination with
full-rank predictor effects you need to additionally use the formula
interface:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>PCGLLVM <span class="ot">&lt;-</span> <span class="fu">gllvm</span>(Y, <span class="at">X =</span> X, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">num.lv.c =</span> <span class="dv">2</span>, </span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                 <span class="at">lv.formula =</span> <span class="sc">~</span>bare.sand <span class="sc">+</span> fallen.leaves <span class="sc">+</span> moss<span class="sc">+</span>herb.layer <span class="sc">+</span> reflection, </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                 <span class="at">formula =</span> <span class="sc">~</span>soil.dry)</span></code></pre></div>
<p>where <code>lv.formula</code> is the formula for the ordination with
predictors (concurrent or constrained), and <code>formula</code> is the
formula which tells the model which predictors should be partialled out
of the ordination. Note, that those two formula arguments cannot include
the same predictor variables, and all predictor variables should be
provided in the <code>X</code> argument. In essence, this performs a
partial concurrent ordination, or with <code>num.RR</code> a partial
constrained ordination. These effects that are partialled out of the
ordination (that the ordination is conditioned on) can also be treated
as random effects, which is sometimes preferable. Partialled out here
means that the effects are taken out of the ordination: the effect of
<code>soil.dry</code> is no longer visible in the ordination, and no
arrow will be drawn for its effect. It is possible to inspect its effect
on the species with the <code>coefplot</code> function, as it is for all
covariate effects in the model, inside the ordination and outside.</p>
<p>Information criteria can be used to determine the correct number of
latent variables, though we did not demonstrate this here. Results of
the model can be examined in more details using the
<code>summary(\cdot)</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">summary</span>(CGLLVM)</span></code></pre></div>
<pre><code>## 
## Call:
## gllvm(y = Y, X = X, num.lv.c = 2, family = &quot;poisson&quot;, starting.val = &quot;zero&quot;)
## 
## Family:  poisson 
## 
## AIC:  1665.321 AICc:  1680.282 BIC:  1840.908 LL:  -786.7 df:  46 
## 
## Informed LVs:  2 
## Constrained LVs:  0 
## Unconstrained LVs:  0 
## Residual standard deviation of LVs:  0.6577 0.5729 
## 
## Formula:  ~ 1 
## LV formula:  ~soil.dry + bare.sand + fallen.leaves + moss + herb.layer + reflection 
## Row effect:  ~ 1 
## 
## Coefficients LV predictors:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## soil.dry(CLV1)      -0.98389    0.33529  -2.934 0.003342 ** 
## bare.sand(CLV1)      0.47349    0.23214   2.040 0.041380 *  
## fallen.leaves(CLV1)  0.33758    0.39012   0.865 0.386866    
## moss(CLV1)           0.67915    0.31526   2.154 0.031224 *  
## herb.layer(CLV1)    -0.40845    0.22679  -1.801 0.071706 .  
## reflection(CLV1)     0.83825    0.37495   2.236 0.025376 *  
## soil.dry(CLV2)       0.93546    0.26428   3.540 0.000401 ***
## bare.sand(CLV2)     -0.02443    0.19079  -0.128 0.898113    
## fallen.leaves(CLV2) -0.84909    0.31374  -2.706 0.006803 ** 
## moss(CLV2)           0.51290    0.23897   2.146 0.031851 *  
## herb.layer(CLV2)     0.42712    0.19684   2.170 0.030013 *  
## reflection(CLV2)     0.17366    0.31602   0.550 0.582646    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Finally, we can use all the other tools in the R-package for
inference, such as creating an ordination diagram with arrows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">ordiplot</span>(CGLLVM, <span class="at">biplot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="plot of chunk ordip6_3" src="data:image/png;base64,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" alt="plot of chunk ordip6_3" />
<p class="caption">
plot of chunk ordip6_3
</p>
</div>
<p>Arrows that show as less intense red (pink), are predictors of which
the confidence interval for the slope includes zero, for at least one of
the two plotted dimensions. There are various arguments included in the
function to improve readability of the figure, have a look at its
documentation. The arrows are always proportional to the size of the
plot, so that the predictor with the largest slope estimate is the
largest arrow. If the predictors have no effect, the slopes <span class="math inline">\(\boldsymbol{B}\)</span> will be close to zero.</p>
<p>It is also possible to use the <code>quadratic</code> flag to fit a
quadratic response model though we will not demonstrate that here, or to
partition variance per latent variable and for specific predictors.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lme4" class="csl-entry">
Bates, D., M. Mächler, B. Bolker, and S. Walker. 2015. <span>“Fitting
Linear Mixed-Effects Models Using Lme4”</span> 67: 1–48.
</div>
<div id="ref-lme4_software" class="csl-entry">
Bates, Douglas, Martin Maechler, Ben Bolker, Steven Walker, Rune Haubo
Bojesen Christensen, Henrik Singmann, Bin Dai, et al. 2024. <span>“Lme4:
Linear Mixed-Effects Models Using <span>‘Eigen’</span> and S4.”</span>
CRAN. <a href="https://CRAN.R-project.org/package=lme4">https://CRAN.R-project.org/package=lme4</a>.
</div>
<div id="ref-vanderVeen2021b" class="csl-entry">
Veen, B. van der, F.K.C. Hui, K.A. Hovstad, and R.B. O’Hara. 2023.
<span>“Concurrent Ordination - Simultaneous Unconstrained and
Constrained Latent Variable Modelling”</span> 14: 683–95.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
